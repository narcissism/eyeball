<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Eyeball Cursor Tracking</title>
<style>
body { margin:0; overflow:hidden; background:#000; }
</style>
</head>
<body>

<script src="https://unpkg.com/three@0.155.0/build/three.min.js"></script>

<script>
// SCENE
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 0.1, 100);
camera.position.z = 3;

// RENDERER
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(window.devicePixelRatio);
document.body.appendChild(renderer.domElement);

// LIGHT
scene.add(new THREE.AmbientLight(0xffffff, 0.5));
const light = new THREE.DirectionalLight(0xffffff, 0.9);
light.position.set(3,3,4);
scene.add(light);

// EYEBALL TEXTURE
const size = 512;
const canvas = document.createElement("canvas");
canvas.width = canvas.height = size;
const ctx = canvas.getContext("2d");

// sclera
ctx.fillStyle = "#f2f2f2";
ctx.fillRect(0,0,size,size);
const shade = ctx.createRadialGradient(180,180,60,256,256,280);
shade.addColorStop(0,"#ffffff");
shade.addColorStop(1,"#d6d6d6");
ctx.fillStyle = shade;
ctx.fillRect(0,0,size,size);

// iris
const irisX = 256, irisY = 256, irisR = 90;
const irisGrad = ctx.createRadialGradient(irisX, irisY,10,irisX,irisY,irisR);
irisGrad.addColorStop(0,"#2a7fa3");
irisGrad.addColorStop(1,"#0b2f3d");
ctx.fillStyle = irisGrad;
ctx.beginPath();
ctx.arc(irisX, irisY, irisR,0,Math.PI*2);
ctx.fill();

// pupil
ctx.fillStyle = "#000";
ctx.beginPath();
ctx.arc(irisX, irisY,35,0,Math.PI*2);
ctx.fill();

const texture = new THREE.CanvasTexture(canvas);

// EYEBALL MESH
const eye = new THREE.Mesh(
    new THREE.SphereGeometry(1,64,64),
    new THREE.MeshStandardMaterial({map:texture, roughness:0.4, metalness:0.05})
);
scene.add(eye);

// MOUSE
const mouse = new THREE.Vector2();
window.addEventListener("mousemove", e=>{
    mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
    mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
});

// RESIZE
window.addEventListener("resize", ()=>{
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});

// ANIMATE
const target = new THREE.Vector3();
function animate(){
    requestAnimationFrame(animate);

    // Raycast to the z=0 plane where the eyeball lives
    target.set(mouse.x, mouse.y, 0.5);
    target.unproject(camera);  // converts from NDC to world space

    // Compute direction from eye center to the target
    const dir = new THREE.Vector3().subVectors(target, eye.position).normalize();

    // Constrain rotation to a limited range so the eye behaves naturally
    const maxAngle = Math.PI/4;
    const yaw = Math.atan2(dir.x, dir.z);
    const pitch = Math.asin(dir.y);

    // smooth rotation toward cursor
    eye.rotation.y += (THREE.MathUtils.clamp(yaw, -maxAngle, maxAngle) - eye.rotation.y) * 0.08;
    eye.rotation.x += (THREE.MathUtils.clamp(pitch, -maxAngle, maxAngle) - eye.rotation.x) * 0.08;

    renderer.render(scene,camera);
}
animate();
</script>

</body>
</html>
