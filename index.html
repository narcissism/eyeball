<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3D Eyeball with Curved Iris</title>
<style>
html, body { margin:0; padding:0; overflow:hidden; background:#111; }
canvas { display:block; }
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let w,h;
function resize(){ w=canvas.width=window.innerWidth; h=canvas.height=window.innerHeight; }
window.addEventListener("resize", resize); resize();

let mouse={x:w/2, y:h/2};
window.addEventListener("mousemove", e=>{ mouse.x=e.clientX; mouse.y=e.clientY; });

let startTime=performance.now();
let time=0;

const eye={
    radius:120,
    irisRadius:45,
    pupilRadius:18,
    rotX:0,
    rotY:0
};

const tears=[];
const splashes=[];

// 3D to 2D projection with simple perspective
function project(x,y,z){
    const fov=500;
    const scale=fov/(fov+z);
    return { x: x*scale + w/2, y: y*scale + h/2, scale };
}

// Draw teardrop shape
function drawTear(x,y,r){
    ctx.beginPath();
    ctx.moveTo(x, y - r*1.6);
    ctx.bezierCurveTo(x - r*0.5, y - r*0.2, x - r*0.5, y + r*1.2, x, y + r*1.6);
    ctx.bezierCurveTo(x + r*0.5, y + r*1.2, x + r*0.5, y - r*0.2, x, y - r*1.6);
    ctx.closePath();
    ctx.fill();
}

// Splash particle
function drawSplash(s){
    ctx.fillStyle="rgba(180,220,255,"+s.alpha+")";
    ctx.beginPath();
    ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    ctx.fill();
}

function draw(){
    ctx.clearRect(0,0,w,h);
    time+=0.02;

    // Eye rotation from mouse
    const dx=mouse.x - w/2;
    const dy=mouse.y - h/2;
    eye.rotX += ((dy/300) - eye.rotX)*0.08;
    eye.rotY += ((dx/300) - eye.rotY)*0.08;

    const cx=w/2, cy=h/2;

    // --- Sclera ---
    const scleraGrad=ctx.createRadialGradient(cx - eye.rotY*eye.radius*0.2, cy - eye.rotX*eye.radius*0.2, eye.radius*0.2, cx, cy, eye.radius);
    scleraGrad.addColorStop(0,"#fff");
    scleraGrad.addColorStop(1,"#d4d4d4");
    ctx.fillStyle=scleraGrad;
    ctx.beginPath();
    ctx.arc(cx,cy,eye.radius,0,Math.PI*2);
    ctx.fill();

    // --- Iris & pupil projected onto sphere ---
    const segments=60; // number of points to draw the iris surface
    const irisPoints=[];
    for(let i=0;i<=segments;i++){
        const angle=i/segments*Math.PI*2;
        const r=eye.irisRadius*Math.sin(angle); 
        const phi=angle;
        // spherical coordinates relative to sphere front
        let x=r*Math.cos(phi);
        let y=r*Math.sin(phi);
        let z=Math.sqrt(eye.irisRadius*eye.irisRadius - x*x - y*y); // points on hemisphere
        // rotate according to eye rotation
        let y1=y*Math.cos(eye.rotX)-z*Math.sin(eye.rotX);
        let z1=y*Math.sin(eye.rotX)+z*Math.cos(eye.rotX);
        y=y1; z=z1;
        let x1=x*Math.cos(eye.rotY)+z*Math.sin(eye.rotY);
        let z2=-x*Math.sin(eye.rotY)+z*Math.cos(eye.rotY);
        x=x1; z=z2;
        irisPoints.push(project(x,y,z));
    }

    // Draw iris by connecting points with gradient fill
    ctx.beginPath();
    for(let i=0;i<irisPoints.length;i++){
        if(i===0) ctx.moveTo(irisPoints[i].x, irisPoints[i].y);
        else ctx.lineTo(irisPoints[i].x, irisPoints[i].y);
    }
    ctx.closePath();
    const irisGrad=ctx.createRadialGradient(cx, cy, eye.irisRadius*0.3, cx, cy, eye.irisRadius);
    irisGrad.addColorStop(0,"#3a2715");
    irisGrad.addColorStop(0.45,"#6e4c2b");
    irisGrad.addColorStop(0.8,"#9c7a3c");
    irisGrad.addColorStop(1,"#1c1208");
    ctx.fillStyle=irisGrad;
    ctx.fill();

    // pupil as circle projected on front
    const pupilX=cx + eye.rotY*eye.radius*0.2;
    const pupilY=cy + eye.rotX*eye.radius*0.2;
    ctx.fillStyle="#000";
    ctx.beginPath();
    ctx.arc(pupilX, pupilY, eye.pupilRadius,0,Math.PI*2);
    ctx.fill();

    // highlight
    ctx.fillStyle="rgba(255,255,255,0.6)";
    ctx.beginPat
